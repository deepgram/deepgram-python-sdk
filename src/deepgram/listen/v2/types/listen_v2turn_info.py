# This file was auto-generated by Fern from our API Definition.

import typing

import pydantic
from ....core.pydantic_utilities import IS_PYDANTIC_V2, UniversalBaseModel
from .listen_v2turn_info_event import ListenV2TurnInfoEvent
from .listen_v2turn_info_words_item import ListenV2TurnInfoWordsItem


class ListenV2TurnInfo(UniversalBaseModel):
    """
    Describes the current turn and latest state of the turn
    """

    type: typing.Literal["TurnInfo"] = "TurnInfo"
    request_id: str = pydantic.Field()
    """
    The unique identifier of the request
    """

    sequence_id: int = pydantic.Field()
    """
    Starts at `0` and increments for each message the server sends to the client.  This includes messages of other types, like `Connected` messages.
    """

    event: ListenV2TurnInfoEvent = pydantic.Field()
    """
    The type of event being reported.
    
    - **Update** - Additional audio has been transcribed, but the turn state hasn't changed
    - **StartOfTurn** - The user has begun speaking for the first time in the turn
    - **EagerEndOfTurn** - The system has moderate confidence that the user has finished speaking for the turn. This is an opportunity to begin preparing an agent reply
    - **TurnResumed** - The system detected that speech had ended and therefore sent an **EagerEndOfTurn** event, but speech is actually continuing for this turn
    - **EndOfTurn** - The user has finished speaking for the turn
    """

    turn_index: int = pydantic.Field()
    """
    The index of the current turn
    """

    audio_window_start: float = pydantic.Field()
    """
    Start time in seconds of the audio range that was transcribed
    """

    audio_window_end: float = pydantic.Field()
    """
    End time in seconds of the audio range that was transcribed
    """

    transcript: str = pydantic.Field()
    """
    Text that was said over the course of the current turn
    """

    words: typing.List[ListenV2TurnInfoWordsItem] = pydantic.Field()
    """
    The words in the `transcript`
    """

    end_of_turn_confidence: float = pydantic.Field()
    """
    Confidence that no more speech is coming in this turn
    """

    if IS_PYDANTIC_V2:
        model_config: typing.ClassVar[pydantic.ConfigDict] = pydantic.ConfigDict(extra="allow", frozen=True)  # type: ignore # Pydantic v2
    else:

        class Config:
            frozen = True
            smart_union = True
            extra = pydantic.Extra.allow
